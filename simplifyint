def mon_pro(a,b,n):
    S = 0
    for i in range(256):
            S = S + a(i)*b
            S = S + S(0)*n
            S = S >> 1
    if S >= n:
        return S-n
    else:
        return S


def mod_exp(M,e,n,P):
    S_mon = mon_pro(P,M,n)
    C = mon_pro(1,P,n)

    for i in (bit_length_e-1 : -1 : -1 ):
        C = mon_pro(C,C,n)
        if e(i) == 1:
            C = mon_pro(S_mon,C,n)
    C = mon_pro(1,C,n)
    return C